
        <html xmlns:v="urn:schemas-microsoft-com:vml"
        xmlns:o="urn:schemas-microsoft-com:office:office"
        xmlns:w="urn:schemas-microsoft-com:office:word"
        xmlns="http://www.w3.org/TR/REC-html40">
        <head><meta http-equiv=Content-Type content="text/html;  
        charset=utf-8">
        <style type="text/css">
            table  
            {  
                border-collapse: collapse;
                border: none;  
                width: 100%;  
            }  
            td  
            {  
                border: solid #CCC 1px;  
            }  
            .codestyle{
                word-break: break-all;
                background:silver;mso-highlight:silver;
            }
        </style>
        <meta name=ProgId content=Word.Document>
        <meta name=Generator content="Microsoft Word 11">
        <meta name=Originator content="Microsoft Word 11">
        <xml><w:WordDocument><w:View>Print</w:View></xml></head>
        <body><h1>1、book_handle.py</h1><div style="margin-left:20px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>数据库添加图书</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>add_book(bookname, writer, press, neededcredit)</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">bookname</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>书名</td>
</tr>
<tr>
<td style="text-align: left;">writer</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>作者</td>
</tr>
<tr>
<td style="text-align: left;">press</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>出版社</td>
</tr>
<tr>
<td style="text-align: left;">neededcredit</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>兑换该书所需积分</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    "state":0
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">int</td>
<td>0:=无错误</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
书名，作者，出版社三者共同决定唯一一本书，都为必填项目</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>获取特定图书信息</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>get_book(bookname, writer, press)</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">bookname</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>书名</td>
</tr>
<tr>
<td style="text-align: left;">writer</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>作者</td>
</tr>
<tr>
<td style="text-align: left;">press</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>出版社</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    "state" : 1
  }
  or
  {
    "state" : 0,
    "infos" : [0, "人间失格", "太宰治", "xx出版社", 34]
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">int</td>
<td>0:=无错误；1:=书目不存在</td>
</tr>
<tr>
<td style="text-align: left;">infos</td>
<td style="text-align: left;">一维列表</td>
<td>[book.booid, book.bookname, book.writer, book.press ,book.neededcredit]</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
无</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>获取所有书目</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>get_all_books()</code></li>
</ul>
<p><strong>参数：</strong> </p>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
   “state" : 0,
   "books" : [
     [0, "人间失格", "太宰治", "xx出版社", 34],
        [1, "人间失格", "太宰治", "yy出版社", 38]
   ]
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">int</td>
<td>0:=无错误</td>
</tr>
<tr>
<td style="text-align: left;">books</td>
<td style="text-align: left;">二维列表</td>
<td>每一维对应一本书： [book.booid, book.bookname, book.writer, book.press ,book.neededcredit]</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
无</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>从数据库中删除书目</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>del_book(bookname, writer, press)</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">bookname</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>书名</td>
</tr>
<tr>
<td style="text-align: left;">writer</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>作者</td>
</tr>
<tr>
<td style="text-align: left;">press</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>出版社</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    "state" : 1
  }
  or
  {
    "state" : 0
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">int</td>
<td>0:=无错误；1:=书目不存在</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
无</p></div><h1>2、bottle_handler.py</h1><div style="margin-left:20px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>数据库添加漂流瓶</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>add_bottle(bookname, writer, press, description_url, photos_urls_str, timeouthandle, sendto):</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">bookname</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>书名</td>
</tr>
<tr>
<td style="text-align: left;">writer</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>作者</td>
</tr>
<tr>
<td style="text-align: left;">press</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>出版社</td>
</tr>
<tr>
<td style="text-align: left;">description_url</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>服务器上读后感文件的路径</td>
</tr>
<tr>
<td style="text-align: left;">photos_urls_str</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>服务器上多张相关图片的路径，同一个字符串中用分号分隔</td>
</tr>
<tr>
<td style="text-align: left;">timeouthandle</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">boolean</td>
<td>该书是否允许超时处理</td>
</tr>
<tr>
<td style="text-align: left;">sendto</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">int</td>
<td>==0 := 未赠出；<0 := 已指定机构；>0:=已被uid为sendto的用户领走</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    "state":0
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">int</td>
<td>0:=无错误</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
书名，作者，出版社三者共同决定唯一一本书，都为必填项目</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>从数据库中删除漂流瓶</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>del_bottle(botid)</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">botid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>该漂流瓶在数据库中分配的id</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    "state" : 1
  }
  or
  {
    "state" : 0,
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">int</td>
<td>0:=无错误；1:=书目不存在</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
无</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>获取特定一个漂流瓶的信息</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>get_bottle(botid)</code></li>
</ul>
<p><strong>参数：</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">botid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>该漂流瓶在数据库中分配的id</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    "state" : 1
  }
  or
  {
    "state" : 0,
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">int</td>
<td>0:=无错误；1:=书目不存在</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
无</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>更新特定一个漂流瓶的文字描述</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>update_description(botid, new_description_url)</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">botid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>该漂流瓶在数据库中分配的id</td>
</tr>
<tr>
<td style="text-align: left;">new_description_url</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>新上传的文字描述文件的路径</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    "state" : 1
  }
  or
  {
    "state" : 0
  }
  or
  {
    "state" : 2
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">int</td>
<td>0:=无错误；1:=书目不存在；2:=原文件不存在</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
无</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>更新shento数据</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>update_sendto(botid, code)</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">botid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>该漂流瓶在数据库中分配的id</td>
</tr>
<tr>
<td style="text-align: left;">code</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td><0 := 该书分配到机构的机构号；>0 := 该书被用户领走的用户uid</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    "state" : 1
  }
  or
  {
    "state" : 0
  }
  or
  {
    "state" : 2
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">int</td>
<td>0:=无错误；1:=书目不存在；2:=该书已被领走</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
无</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>更新shento数据</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>update_sendto(botid, code)</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">botid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>该漂流瓶在数据库中分配的id</td>
</tr>
<tr>
<td style="text-align: left;">code</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td><0 := 该书分配到机构的机构号；>0 := 该书被用户领走的用户uid</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    "state" : 1
  }
  or
  {
    "state" : 0
  }
  or
  {
    "state" : 2
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">int</td>
<td>0:=无错误；1:=书目不存在；2:=该书已被领走</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
无</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>更新是否允许超时处理</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>update_timeouthandle(botid, new_choice)</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">botid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>该漂流瓶在数据库中分配的id</td>
</tr>
<tr>
<td style="text-align: left;">new_choice</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">boolean</td>
<td>是否允许超时处理</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    "state" : 1
  }
  or
  {
    "state" : 0
  }
  or
  {
    "state" : 2
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">int</td>
<td>0:=无错误；1:=书目不存在；2:=该书已被领走</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
无</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>更新上传者角度的书本状态</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>update_state(botid, new_state)</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">botid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>该漂流瓶在数据库中分配的id</td>
</tr>
<tr>
<td style="text-align: left;">new_state</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>1：未入库 2：已入库 3：已拒收 4：已捐赠</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    "state" : 1
  }
  or
  {
    "state" : 0
  }
  or
  {
    "state" : 2
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">int</td>
<td>0:=无错误；1:=书目不存在；2:=该书已被领走</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
无</p></div><h1>3、user_handle.py</h1><div style="margin-left:20px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>数据库添加用户，同时创建该用户相关的star表</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>add_user(username, password, phonenumber)</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">username</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>用户名</td>
</tr>
<tr>
<td style="text-align: left;">password</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>密码</td>
</tr>
<tr>
<td style="text-align: left;">phonenumber</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>注册手机号</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    "state":0
  }
  or
  {
    "state":1
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">int</td>
<td>0:=无错误；1:=用户已存在</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
无</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>从数据库中删除用户</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>del_user(uid)</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">uid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>数据库中给用户分配的id</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    "state" : 1
  }
  or
  {
    "state" : 0
    }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">int</td>
<td>0:=无错误；1:=用户不存在</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
无</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>验证用户名密码是否一致并返回uid</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>check_user_with_username(username, password)</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">username</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>用户名</td>
</tr>
<tr>
<td style="text-align: left;">password</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>密码</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>   {
    "state" : 1
  }
  or
  {
    "state" : 0,
    "uid" : id
  }
  or
  {
    "state" : 2
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">int</td>
<td>0:=无错误；1:=用户不存在；2:=密码错误</td>
</tr>
<tr>
<td style="text-align: left;">uid</td>
<td style="text-align: left;">int</td>
<td>用户id</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
无</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>验证手机号密码是否一致并返回uid</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>check_user_with_phonenumber(phonenumber, password)</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">phonenumber</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>手机号</td>
</tr>
<tr>
<td style="text-align: left;">password</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>密码</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    "state" : 1
  }
  or
  {
    "state" : 0,
    "uid" : id
  }
  or
  {
    "state" : 2
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">int</td>
<td>0:=无错误；1:=用户不存在；2:=密码错误</td>
</tr>
<tr>
<td style="text-align: left;">uid</td>
<td style="text-align: left;">int</td>
<td>用户id</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
无</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>数据库中修改密码</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>update_password(uid, new_password)</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">uid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>数据库中给用户分配的id</td>
</tr>
<tr>
<td style="text-align: left;">new_password</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>新密码</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    "state" : 1
  }
  or
  {
    "state" : 0
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">int</td>
<td>0:=无错误；1:=用户不存在</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
无</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>数据库中修改绑定手机号</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>update_phonenumber(uid, new_phonenumber)</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">uid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>数据库中给用户分配的id</td>
</tr>
<tr>
<td style="text-align: left;">new_phonenumber</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>新手机号</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    "state" : 1
  }
  or
  {
    "state" : 0
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">int</td>
<td>0:=无错误；1:=用户不存在</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
无</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>数据库中修改地址</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>update_address(uid, new_address)</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">uid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>数据库中给用户分配的id</td>
</tr>
<tr>
<td style="text-align: left;">new_address</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>新地址</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    "state" : 1
  }
  or
  {
    "state" : 0
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">int</td>
<td>0:=无错误；1:=用户不存在</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
无</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>数据库中为该用户增加delta积分</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>increase_credit(uid, delta)</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">uid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>数据库中给用户分配的id</td>
</tr>
<tr>
<td style="text-align: left;">delta</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>积分增量，可正可负</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    "state" : 1
  }
  or
  {
    "state" : 0
  }
  or
  {
    "state" : 2
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">int</td>
<td>0:=无错误；1:=用户不存在 ；2:=增量异常，使得结果为负值</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
无</p></div><h1>4、ust_handler.py</h1><div style="margin-left:20px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>为新用户创建star表</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>create_stars_table(uid)</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">uid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>数据库中给用户分配的id</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<p><strong>返回参数说明</strong> </p>
<p><strong>备注</strong>
无</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>删除用户的star表</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>delete_stars_table(uid)</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">uid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>数据库中给用户分配的id</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<p><strong>返回参数说明</strong> </p>
<p><strong>备注</strong>
无</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>增加一条star记录</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>insert_stars_table(uid, bid, isself)</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">uid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>数据库中给用户分配的id</td>
</tr>
<tr>
<td style="text-align: left;">bid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>漂流瓶id</td>
</tr>
<tr>
<td style="text-align: left;">isself</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">boolean</td>
<td>用户自己发的漂流瓶也当作star来记录，用该参数用于区别用户的漂流瓶和star的漂流瓶</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<p><strong>返回参数说明</strong> </p>
<p><strong>备注</strong>
无</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>返回特定用户的所有star记录</li>
</ul>
<p><strong>接口函数：</strong> </p>
<ul>
<li><code>select_stars_table(uid)</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">uid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>数据库中给用户分配的id</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  [
    [0, true],
      [2, false]
  ]</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">bottles</td>
<td style="text-align: left;">二维列表</td>
<td>每一维是一个stared bottle：[bottle's id, isself]</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
无</p></div></body></html>